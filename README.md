这是一个轻量级的队列库，支持队列的创建、写入、读取、窥读、强制写队列头等功能，不依赖于具体的硬件，可在任意C语言平台上使用。

## 如何移植

因为该工具库不依赖于具体的硬件，直接添加进自己的工程就可以编译使用。如果代码文件内的中文注释出现乱码，那是打开文件的编码不正确所致，本工具库使用utf8编码编写，用户可以将代码文件转换成自己的编码再进行使用。

## 如何使用

1. 定义队列对象，如：  

`lwq_t test_que;`

特别注意，一定要将队列对象定义成具体的一般变量，不能单独定义成指针。如果一定要使用指针，可以这样写：

``````c
lwq_t test_que;
lwq_t* p_test_que = &test_que;
``````

2. 根据自己的需求创建队列，如：

`lwq_create(&test_que, 5, sizeof(char));`

创建出队列后就可以对队列进行读写等操作。因为队列内部具有拷贝机制，因此用户不需要保证写入的数据一直可用，除非用户写入的是指针变量。

## 内存钩子

队列库需要依赖动态内存管理进行运作，同时支持用户自定义内存管理钩子，用户可以使用自己的内存管理方式来使用本队列库。代码编写示例：

``````
void lwq_set_hook(void)
{
	lwq_hook_t new_hooks;
	new_hooks.lwq_malloc = my_malloc;
	new_hooks.lwq_free   = my_free;
	lwq_hook_init(&new_hooks);
}
``````

## 线程安全

本队列库为了实现读写隔离，需要牺牲队列中的一个元素，因此在创建队列时，队列实际上会多创建一个元素。就比如用户调用函数创建一个长度为5的队列，实际队列的长度应为5 + 1 = 6，只是多创建的这一个元素用户无法使用，仅仅用来判断的队列的空或满。

本库创建出来的队列允许边读边写，但不允许发生并发读以及并发写，否则用户需要自行做好互斥或中断管理。